{"version":3,"sources":["../../../lib/doc/image.js"],"names":["colCache","require","Anchor","Image","worksheet","model","prototype","type","imageId","range","tl","br","ext","Error","decoded","decode","col","left","row","top","right","bottom","editAs","module","exports"],"mappings":";;AAAA,IAAMA,QAAQ,GAAGC,OAAO,CAAC,oBAAD,CAAxB;;AACA,IAAMC,MAAM,GAAGD,OAAO,CAAC,UAAD,CAAtB;;AAEA,IAAME,KAAK,GAAG,SAARA,KAAQ,CAASC,SAAT,EAAoBC,KAApB,EAA2B;AACvC,OAAKD,SAAL,GAAiBA,SAAjB;AACA,OAAKC,KAAL,GAAaA,KAAb;AACD,CAHD;;AAKAF,KAAK,CAACG,SAAN,GAAkB;AAChB,MAAID,KAAJ,GAAY;AACV,YAAQ,KAAKE,IAAb;AACE,WAAK,YAAL;AACE,eAAO;AACLA,UAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,UAAAA,OAAO,EAAE,KAAKA;AAFT,SAAP;;AAIF,WAAK,OAAL;AACE,eAAO;AACLD,UAAAA,IAAI,EAAE,KAAKA,IADN;AAELC,UAAAA,OAAO,EAAE,KAAKA,OAFT;AAGLC,UAAAA,KAAK,EAAE;AACLC,YAAAA,EAAE,EAAE,KAAKD,KAAL,CAAWC,EAAX,CAAcL,KADb;AAELM,YAAAA,EAAE,EAAE,KAAKF,KAAL,CAAWE,EAAX,IAAiB,KAAKF,KAAL,CAAWE,EAAX,CAAcN,KAF9B;AAGLO,YAAAA,GAAG,EAAE,KAAKH,KAAL,CAAWG;AAHX;AAHF,SAAP;;AASF;AACE,cAAM,IAAIC,KAAJ,CAAU,oBAAV,CAAN;AAjBJ;AAmBD,GArBe;;AAuBhB,MAAIR,KAAJ,OAAoC;AAAA,QAAxBE,IAAwB,QAAxBA,IAAwB;AAAA,QAAlBC,OAAkB,QAAlBA,OAAkB;AAAA,QAATC,KAAS,QAATA,KAAS;AAClC,SAAKF,IAAL,GAAYA,IAAZ;AACA,SAAKC,OAAL,GAAeA,OAAf;;AAEA,QAAID,IAAI,KAAK,OAAb,EAAsB;AACpB,UAAI,OAAOE,KAAP,KAAiB,QAArB,EAA+B;AAC7B,YAAMK,OAAO,GAAGd,QAAQ,CAACe,MAAT,CAAgBN,KAAhB,CAAhB;AACA,aAAKA,KAAL,GAAa;AACXC,UAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;AAAEY,YAAAA,GAAG,EAAEF,OAAO,CAACG,IAAf;AAAqBC,YAAAA,GAAG,EAAEJ,OAAO,CAACK;AAAlC,WAA3B,EAAoE,CAAC,CAArE,CADO;AAEXR,UAAAA,EAAE,EAAE,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2B;AAAEY,YAAAA,GAAG,EAAEF,OAAO,CAACM,KAAf;AAAsBF,YAAAA,GAAG,EAAEJ,OAAO,CAACO;AAAnC,WAA3B,EAAwE,CAAxE,CAFO;AAGXC,UAAAA,MAAM,EAAE;AAHG,SAAb;AAKD,OAPD,MAOO;AACL,aAAKb,KAAL,GAAa;AACXC,UAAAA,EAAE,EAAE,IAAIR,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACC,EAAjC,EAAqC,CAArC,CADO;AAEXC,UAAAA,EAAE,EAAEF,KAAK,CAACE,EAAN,IAAY,IAAIT,MAAJ,CAAW,KAAKE,SAAhB,EAA2BK,KAAK,CAACE,EAAjC,EAAqC,CAArC,CAFL;AAGXC,UAAAA,GAAG,EAAEH,KAAK,CAACG,GAHA;AAIXU,UAAAA,MAAM,EAAEb,KAAK,CAACa;AAJH,SAAb;AAMD;AACF;AACF;;AA5Ce,CAAlB;AA+CAC,MAAM,CAACC,OAAP,GAAiBrB,KAAjB","sourcesContent":["const colCache = require('../utils/col-cache');\nconst Anchor = require('./anchor');\n\nconst Image = function(worksheet, model) {\n  this.worksheet = worksheet;\n  this.model = model;\n};\n\nImage.prototype = {\n  get model() {\n    switch (this.type) {\n      case 'background':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n        };\n      case 'image':\n        return {\n          type: this.type,\n          imageId: this.imageId,\n          range: {\n            tl: this.range.tl.model,\n            br: this.range.br && this.range.br.model,\n            ext: this.range.ext,\n          },\n        };\n      default:\n        throw new Error('Invalid Image Type');\n    }\n  },\n\n  set model({ type, imageId, range }) {\n    this.type = type;\n    this.imageId = imageId;\n\n    if (type === 'image') {\n      if (typeof range === 'string') {\n        const decoded = colCache.decode(range);\n        this.range = {\n          tl: new Anchor(this.worksheet, { col: decoded.left, row: decoded.top }, -1),\n          br: new Anchor(this.worksheet, { col: decoded.right, row: decoded.bottom }, 0),\n          editAs: 'oneCell',\n        };\n      } else {\n        this.range = {\n          tl: new Anchor(this.worksheet, range.tl, 0),\n          br: range.br && new Anchor(this.worksheet, range.br, 0),\n          ext: range.ext,\n          editAs: range.editAs,\n        };\n      }\n    }\n  },\n};\n\nmodule.exports = Image;\n"],"file":"image.js"}